# Roadmap de Desarrollo Frontend para "LifeBit" (React)

## Epopeya F0: Configuraci√≥n del Proyecto y Arquitectura Frontend (CORE-FE)
*******************************************************************************

*   `[x]` **CORE-FE-02:** Estructurar las carpetas del proyecto (componentes, p√°ginas, servicios, hooks, etc.).
*   `[x]` **CORE-FE-01:** Configurar un nuevo proyecto de React usando `Vite` (herramienta de construcci√≥n moderna y r√°pida).
*   `[x]` **CORE-FE-03:** Configurar un sistema de enrutamiento con `React Router DOM` para manejar la navegaci√≥n entre p√°ginas.
*   `[x]` **CORE-FE-04:** Implementar una librer√≠a de componentes de UI (ej. `Material-UI`, `Chakra UI`, o `Tailwind CSS`) para un desarrollo visual r√°pido y consistente.
*   `[x]` **CORE-FE-05:** Configurar un gestor de estado global (ej. `Zustand` o `Redux Toolkit`) para manejar el estado de la autenticaci√≥n y los datos compartidos.
*   `[x]` **CORE-FE-06:** Crear un servicio `apiService` (usando `axios`) para centralizar todas las llamadas a nuestra API del backend.

---

## Epopeya F1: Flujo de Autenticaci√≥n y Vistas P√∫blicas (AUTH-FE)
*******************************************************************************

*   `[x]` **AUTH-FE-01:** Construir la Landing Page p√∫blica con sus secciones (basado en el CMS del backend).
*   `[x]` **AUTH-FE-02:** Construir la p√°gina de Login con los formularios para inicio de sesi√≥n tradicional y el bot√≥n de "Iniciar sesi√≥n con Google".
*   `[x]` **AUTH-FE-03:** Implementar la l√≥gica de login que llama a la API, guarda el JWT y el Refresh Token de forma segura (usando cookies HttpOnly).
*   `[x]` **AUTH-FE-04:** Construir la p√°gina "Finalizar Registro" para usuarios invitados por token.
*   `[x]` **AUTH-FE-05:** Crear "Rutas Protegidas" que solo sean accesibles para usuarios autenticados.
*   `[x]` **AUTH-FE-06:** Implementar la l√≥gica de "logout".

---

## Epopeya F2: Panel de Due√±os (DUE√ëO-FE)
*******************************************************************************

*   `[x]` **DUE√ëO-FE-01:** Construir el Layout principal del Dashboard del Due√±o (sidebar, header).
*   `[ ]` **DUE√ëO-FE-02:** **[M√≥dulo Edificios]** - Crear la vista de tabla para listar edificios, con filtros y paginaci√≥n.
*   `[ ]` **DUE√ëO-FE-03:** **[M√≥dulo Edificios]** - Crear los formularios (en modales o p√°ginas separadas) para crear y editar un edificio.
*   `[ ]` **DUE√ëO-FE-04:** **[Dashboard Principal]** - Construir los componentes de las tarjetas de notificaci√≥n y la tabla de "Contratos Pr√≥ximos a Vencer".
*   `[ ]` **DUE√ëO-FE-05:** **[Dashboard Financiero]** - Integrar una librer√≠a de gr√°ficos (ej. `Chart.js` o `Recharts`) y conectarla a los endpoints de la API para mostrar las m√©tricas.
*   `[ ]` **DUE√ëO-FE-06:** **[M√≥dulo CMS]** - Crear la interfaz para gestionar el contenido de la Landing Page, incluyendo la funcionalidad de drag-and-drop para reordenar secciones.

---

## Epopeya F3: Panel de Administradores (ADMIN-FE)
*******************************************************************************

*   `[x]` **ADMIN-FE-01:** Construir el Layout principal del Dashboard del Administrador.
*   `[x]` **ADMIN-FE-02:** **[Registro de Residentes]** - Implementar el formulario para el registro manual y el componente de subida de archivos para la carga masiva.
*   `[x]` **ADMIN-FE-03:** **[Recursos]** - Construir la interfaz visual de cuadr√≠cula para la asignaci√≥n de puestos de estacionamiento.
*   `[ ]` **ADMIN-FE-04:** **[Finanzas]** - Construir los componentes de gr√°ficos y tablas para la vista financiera del administrador.
*   `[ ]` **ADMIN-FE-05:** **[Motor de Reglas]** - Dise√±ar e implementar la interfaz de usuario de "drag-and-drop" para la creaci√≥n de reglas (esta es una tarea de alta complejidad).
*   `[ ]` **ADMIN-FE-06:** **[Noticias]** - Integrar un editor de texto enriquecido (CKEditor) en un formulario para crear/editar noticias.

---

## Epopeya F4: Panel de Residentes (RESIDENTE-FE)
*******************************************************************************

*   `[x]` **RESIDENTE-FE-01:** Construir el Layout y el Dashboard principal del Residente.
*   `[ ]` **RESIDENTE-FE-02:** **[Recibos y Pagos]** - Crear la vista para mostrar los recibos de condominio y el formulario para reportar un pago (incluyendo la subida del comprobante).
*   `[ ]` **RESIDENTE-FE-03:** **[Reservas]** - Implementar el componente de calendario y el formulario para solicitar reservas.
*   `[ ]` **RESIDENTE-FE-04:** **[Votaciones y Elecciones]** - Construir las interfaces para participar en encuestas y votar por candidatos.
*   `[ ]` **RESIDENTE-FE-05:** **[Discusiones]** - Crear la interfaz del foro con su estructura de hilos y respuestas anidadas.


# Roadmap Frontend para "LifeBit" (React)

## Epopeya F0: Fundaci√≥n del Proyecto (CORE-FE) `[PR√ìXIMA A INICIAR]`
*   `[x]` **CORE-FE-01 a CORE-FE-06:** Configuraci√≥n de Vite, carpetas, `React Router`, librer√≠a de UI, gestor de estado (`Zustand`) y `apiService` (`axios`).

## Epopeya F1: Acceso y Vistas P√∫blicas (AUTH-FE)
*   `[ ]` **AUTH-FE-01: [P√°gina]** - Construir la Landing Page p√∫blica (renderizada desde el CMS).
*   `[x]` **AUTH-FE-02: [Componente]** - Construir el formulario de "Solicitud de Servicio".
*   `[x]` **AUTH-FE-03: [P√°gina]** - Construir la p√°gina de Login con sus componentes (login tradicional y con Google).
*   `[x]` **AUTH-FE-04: [L√≥gica]** - Implementar la l√≥gica de login, guardado seguro de tokens y redirecci√≥n basada en rol.
*   `[x]` **AUTH-FE-05: [Componente]** - Crear el HOC (High-Order Component) o Hook de "Ruta Protegida".
*   `[x]` **AUTH-FE-06: [P√°gina]** - Construir la p√°gina "Finalizar Registro" para usuarios invitados.
*   `[x]` **AUTH-FE-07: [Componente]** - Construir el Layout principal (Sidebar, Header) que se adapta al rol del usuario.

## Epopeya F2: Vistas de M√≥dulos Fundamentales
*   `[ ]` **VISTA-01: [Edificios]** - Construir la p√°gina de gesti√≥n de edificios (tabla, filtros, modales de creaci√≥n/edici√≥n) para el Due√±o.
*   `[x]` **VISTA-02: [Usuarios]** - Construir la p√°gina de gesti√≥n de residentes para el Admin (tabla, formulario manual, componente de subida masiva).
*   `[ ]` **VISTA-03: [Cuentas]** - Construir la p√°gina de gesti√≥n de Cuentas Bancarias para el Admin.
*   `[x]` **VISTA-04: [Recursos]** - Construir la interfaz de gesti√≥n de Recursos para el Admin.

## Epopeya F3: Vistas de Flujos Financieros
*   `[ ]` **VISTA-F-01: [Gastos]** - Construir la interfaz para que el Admin registre los gastos mensuales.
*   `[ ]` **VISTA-F-02: [Recibos]** - Construir la vista que muestra el desglose de un recibo para el Residente.
*   `[ ]` **VISTA-F-03: [Reporte de Pagos]** - Construir el formulario para que el Residente y el Admin reporten un pago.
*   `[ ]` **VISTA-F-04: [Conciliaci√≥n]** - Construir la interfaz para que el Admin/Due√±o suba el estado de cuenta y vea los resultados del "matching".
*   `[ ]` **VISTA-F-05: [Dashboards Financieros]** - Integrar una librer√≠a de gr√°ficos para crear los dashboards del Due√±o y del Admin.

## Epopeya F4: Vistas de Comunidad e Interacci√≥n
*   `[ ]` **VISTA-C-01: [Noticias]** - Construir la vista para leer noticias y el formulario con CKEditor para crearlas.
*   `[ ]` **VISTA-C-02: [Foro]** - Construir la interfaz del foro con su vista de hilos y respuestas anidadas.
*   `[ ]` **VISTA-C-03: [Encuestas/Votaciones]** - Construir la interfaz para crear y para participar en encuestas.
*   `[ ]` **VISTA-C-04: [Elecciones]** - Construir las vistas para el registro de candidaturas y la emisi√≥n de votos.
*   `[ ]` **VISTA-C-05: [Reservas]** - Construir el componente de calendario y el flujo de solicitud de reservas.
*   `[ ]` **VISTA-C-06: [Motor de Reglas]** - (La m√°s compleja) Construir la interfaz drag-and-drop para la creaci√≥n de reglas.



Roadmap Maestro del Frontend de LifeBit (v2.0 - Consolidado)
Nuestra Estrella Polar: "Construir la plataforma SaaS m√°s intuitiva, potente y adictiva para la gesti√≥n de condominios, transformando tareas complejas en experiencias simples y gratificantes."
Documento Fundacional: Este roadmap se rige por nuestro Manifiesto de Dise√±o y Experiencia de LifeBit, que prioriza el modo oscuro, la psicolog√≠a del comportamiento, el benchmarking de aplicaciones de clase mundial y la internacionalizaci√≥n (i18n).
Leyenda de Tareas:
[CORE]: Tarea de Arquitectura o Fundaci√≥n.
[UI/UX]: Tarea centrada en la Interfaz o Experiencia de Usuario.
[L√ìGICA]: Tarea centrada en la gesti√≥n de estado y comunicaci√≥n con la API.
[P√ÅGINA]: Creaci√≥n de una vista principal.
[COMPONENTE]: Creaci√≥n de un bloque de UI reutilizable.

Leyenda de Estado:
[x]: Tarea Completada
[~]: Tarea en Progreso o Parcialmente Completada
[ ]: Tarea Pendiente

Epopeya F0: La Plataforma de Lanzamiento (Fundaci√≥n y Arquitectura)
Objetivo: Forjar el esqueleto de nuestra aplicaci√≥n. La base invisible pero indestructible sobre la que construiremos todo lo dem√°s.
[x] F0-01 [CORE]: Definir el Manifiesto de Dise√±o y Experiencia de LifeBit.
[x] Paleta de colores (Modo Oscuro y Claro).
[x] Escala tipogr√°fica y de espaciado.
[x] Set de iconograf√≠a y tono de voz.
[ ] F0-02 [CORE]: Configurar la librer√≠a de internacionalizaci√≥n (i18next) para soporte es/en.
[x] F0-03 [L√ìGICA]: Crear el apiService definitivo con axios, incluyendo withCredentials: true y el interceptor de accessToken.
[x] F0-04 [UI/UX]: Construir el LayoutPrincipal adaptable (Header/Sidebar) que cambia seg√∫n el rol del usuario (due√±o, admin, residente).
[x] F0-05 [UI/UX]: Refactorizar y perfeccionar el componente ThemeToggle para el cambio de tema.
[x] F0-06 [CORE]: Configurar el App.jsx con el BrowserRouter y la estructura de rutas principal.

Epopeya F1: La Puerta de Entrada (Autenticaci√≥n y Vistas P√∫blicas)
Objetivo: Crear un flujo de acceso y onboarding impecable, seguro y persistente para todos los roles.
[x] F1-01 [L√ìGICA]: Construir el authStore de Zustand con toda la l√≥gica de estado (login, logout, refreshToken, getProfile).
[x] F1-02 [COMPONENTE]: Construir el SessionVerifier para restaurar la sesi√≥n del usuario al recargar la p√°gina.
[x] F1-03 [CORE]: Implementar el componente RutaProtegida para blindar las vistas privadas.
[x] F1-04 [P√ÅGINA]: Conectar y finalizar la LoginPage (l√≥gica de estado, errores, carga).
[x] F1-05 [P√ÅGINA]: Construir la FinalizarRegistroPage para usuarios invitados por token.
[x] F1-06 [P√ÅGINA]: Construir el flujo de recuperaci√≥n de cuenta (ForgotPasswordPage y ResetPasswordPage).
[x] F1-07 [P√ÅGINA]: Construir la AuthCallbackPage para el login con Google.
[x] F1-08 [P√ÅGINA]: Construir y conectar la LandingPage con su SolicitudForm.

Epopeya F2: El Centro de Comando (Panel del Due√±o)
Objetivo: Empoderarte, Julio, con las herramientas para dirigir tu negocio con total control y visibilidad.
[ ] F2-01 [P√ÅGINA]: Construir el DashboardPrincipal del Due√±o (Notificaciones, Resumen de Edificios, Contratos a Vencer).
[ ] F2-02 [P√ÅGINA]: Construir el DashboardFinanciero del Due√±o con gr√°ficos interactivos.
[ ] F2-03 [P√ÅGINA]: M√≥dulo de Gesti√≥n de Solicitudes (Tabla para listar, Modal para aprobar/rechazar).
[ ] F2-04 [P√ÅGINA]: M√≥dulo de Gesti√≥n de Contratos (Tabla, filtros, vista de detalle).
[ ] F2-04a [COMPONENTE]: Formulario de "Registro de Edificio" para clientes VIP.
[ ] F2-05 [P√ÅGINA]: M√≥dulo CMS para la Landing Page con drag and drop para reordenar secciones.
[ ] F2-06 [P√ÅGINA]: Herramienta de Soporte de Base de Datos (SQL Runner).

Epopeya F3: El Primer Vuelo (Onboarding del Administrador)
Objetivo: Crear una experiencia de configuraci√≥n inicial tan guiada y gratificante que los nuevos administradores se sientan empoderados desde el primer minuto.
[x] F3-01 [COMPONENTE]: Construir el orquestador SetupWizard que guiar√° todo el proceso.
[x] F3-02 [P√ÅGINA]: Paso 1: Interfaz de Creaci√≥n de Unidades (usando el generador flexible).
[x] F3-03 [P√ÅGINA]: Paso 2: M√≥dulo de Gesti√≥n de Recursos.
[x] F3-03a [UI/UX]: CRUD para Tipos de Recurso.
[x] F3-03b [UI/UX]: Interfaces para la creaci√≥n de inventario (secuencial y carga masiva por Excel).
[x] F3-04 [P√ÅGINA]: Paso 3: M√≥dulo de Invitaci√≥n de Residentes (individual y carga masiva por Excel).

Epopeya F4: La Comunidad Viva (Paneles de Admin y Residente)
Objetivo: Construir las herramientas del d√≠a a d√≠a que hacen de LifeBit el centro neur√°lgico de la comunidad.
[ ] F4-01 [P√ÅGINA]: Construir el DashboardPrincipal del Administrador.
[ ] F4-02 [P√ÅGINA]: Construir el DashboardPrincipal del Residente.
[ ] F4-03 [P√ÅGINA]: M√≥dulo de Discusiones (Foro Social v1).
[ ] F4-03a [UI/UX]: Vista de hilos y respuestas anidadas.
[ ] F4-03b [L√ìGICA]: Implementaci√≥n de Reacciones (likes).
[ ] F4-03c [L√ìGICA]: Sistema de notificaciones multicanal para respuestas.
[ ] F4-04 [P√ÅGINA]: M√≥dulo de Elecciones v1.
[ ] F4-04a [UI/UX]: Interfaz para postulaci√≥n de candidatos.
[ ] F4-04b [UI/UX]: Interfaz de votaci√≥n.
[ ] F4-04c [UI/UX]: Vista de resultados.
[ ] F4-05 [P√ÅGINA]: M√≥dulo de Gesti√≥n Visual de Recursos (Vista de "Puestos").
[ ] F4-06 [P√ÅGINA]: Sistema de Reportes/Ticketing (vistas para Residente, Admin y Due√±o).
[ ] F4-07 [P√ÅGINA]: Flujo de Pagos y Conciliaci√≥n (vistas para Residente, Admin y Due√±o).

Epopeya F5: El Coraz√≥n de LifeBit (Motor de Reglas Visual)
Objetivo: Implementar nuestra killer feature. La herramienta que nos define y nos diferencia de forma radical.
[ ] F5-01 [L√ìGICA]: (Fase 1 - MVP Funcional) Implementar las reglas m√°s comunes a trav√©s de formularios simples para entregar valor r√°pidamente.
[ ] F5-02 [UI/UX]: (Fase 2 - La Revoluci√≥n Visual) Construir la interfaz drag and drop.
[ ] F5-02a [COMPONENTE]: Paleta de bloques de Condiciones y Acciones.
[ ] F5-02b [COMPONENTE]: Lienzo para la construcci√≥n de reglas.
[ ] F5-02c [L√ìGICA]: Motor de Simulaci√≥n para previsualizar el impacto de una regla.
[ ] F5-02d [UI/UX]: Asistente guiado (tour interactivo) para la creaci√≥n de la primera regla.


üìã ADR-007: Funcionalidad de Reenv√≠o de Invitaciones
üìÖ Fecha: 20 de septiembre de 2025
üë§ Autor: Arquitecto de LifeBit
üìä Estado: Propuesto
üéØ Contexto
Los tokens de invitaci√≥n de residentes expiran despu√©s de 24 horas, causando frustraci√≥n en administradores que necesitan reenviar invitaciones manualmente. Actualmente, no existe una forma eficiente de reenviar invitaciones desde la interfaz de administraci√≥n.

Problema identificado:

Tokens expiran despu√©s de 24 horas
No hay forma de reenviar invitaciones desde la UI
Administradores deben crear nuevas invitaciones manualmente
P√©rdida de tiempo y experiencia de usuario deficiente
üéØ Decisi√≥n
Implementar funcionalidad de reenv√≠o de invitaciones con las siguientes caracter√≠sticas:

Alcance:
‚úÖ Reenv√≠o de invitaciones para residentes pendientes
‚úÖ L√≠mite de 3 reenv√≠os por residente
‚úÖ Historial de reenv√≠os para auditor√≠a
‚úÖ UI intuitiva integrada en la lista de residentes
‚úÖ Mensajes contextuales seg√∫n tiempo transcurrido
Fuera de alcance:
‚ùå Reenv√≠o masivo de invitaciones
‚ùå Personalizaci√≥n avanzada de emails
‚ùå Integraci√≥n con servicios externos de email
üèóÔ∏è Soluci√≥n T√©cnica
Backend Implementation
1. Nueva Tabla: historial_reenvios
CREATE TABLE historial_reenvios (
    id SERIAL PRIMARY KEY,
    residente_id INTEGER NOT NULL REFERENCES residentes(id) ON DELETE CASCADE,
    fecha_reenvio TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ip_admin INET,
    resultado ENUM('exitoso', 'fallido', 'excedido') DEFAULT 'exitoso',
    mensaje_error TEXT,
    token_expiracion TIMESTAMP,
    contador_reenvios INTEGER DEFAULT 1,
    
    INDEX idx_residente_fecha (residente_id, fecha_reenvio),
    INDEX idx_resultado (resultado)
);
2. Actualizar Tabla: residentes
ALTER TABLE residentes 
ADD COLUMN reenvios_realizados INTEGER DEFAULT 0,
ADD COLUMN ultimo_reenvio TIMESTAMP NULL,
ADD COLUMN token_expiracion TIMESTAMP NULL;
3. Nuevo Endpoint: POST /admin/residentes/:id/reenviar-invitacion
Controller (controllers/admin/residentes.js):

const reenviarInvitacion = async (req, res) => {
    const { id } = req.params;
    const adminIp = req.ip;
    
    try {
        // 1. Verificar que el residente existe y est√° pendiente
        const residente = await Residentes.findByPk(id);
        if (!residente) {
            return res.status(404).json({
                success: false,
                error: 'RESIDENTE_NO_ENCONTRADO',
                message: 'Residente no encontrado'
            });
        }
        
        if (residente.estado !== 'pendiente') {
            return res.status(400).json({
                success: false,
                error: 'RESIDENTE_YA_ACTIVO',
                message: 'Este residente ya est√° activo'
            });
        }
        
        // 2. Verificar l√≠mite de reenv√≠os
        if (residente.reenvios_realizados >= 3) {
            return res.status(403).json({
                success: false,
                error: 'REENVIOS_EXCEDIDOS',
                message: 'Este residente ya ha recibido 3 reenv√≠os',
                data: {
                    reenvios_realizados: residente.reenvios_realizados,
                    limite_maximo: 3
                }
            });
        }
        
        // 3. Generar nuevo token
        const nuevoToken = generarTokenInvitacion();
        const expiracion = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 horas
        
        // 4. Actualizar residente
        await residente.update({
            token_invitacion: nuevoToken,
            token_expiracion: expiracion,
            reenvios_realizados: residente.reenvios_realizados + 1,
            ultimo_reenvio: new Date()
        });
        
        // 5. Registrar en historial
        await HistorialReenvios.create({
            residente_id: id,
            ip_admin: adminIp,
            token_expiracion: expiracion,
            contador_reenvios: residente.reenvios_realizados + 1
        });
        
        // 6. Enviar email
        await enviarEmailInvitacion({
            email: residente.email,
            nombre: residente.nombre,
            token: nuevoToken,
            edificio: residente.edificio.nombre
        });
        
        // 7. Respuesta exitosa
        res.json({
            success: true,
            message: 'Invitaci√≥n reenviada exitosamente',
            data: {
                residente_id: id,
                email: residente.email,
                reenvios_realizados: residente.reenvios_realizados + 1,
                reenvios_disponibles: 2 - residente.reenvios_realizados,
                nuevo_token_expiracion: expiracion,
                ultimo_reenvio: new Date()
            }
        });
        
    } catch (error) {
        console.error('Error en reenv√≠o de invitaci√≥n:', error);
        
        // Registrar error en historial
        await HistorialReenvios.create({
            residente_id: id,
            ip_admin: adminIp,
            resultado: 'fallido',
            mensaje_error: error.message
        });
        
        res.status(500).json({
            success: false,
            error: 'ERROR_INTERNO',
            message: 'Error interno del servidor'
        });
    }
};
4. Modelo: models/HistorialReenvios.js
const { DataTypes } = require('sequelize');

module.exports = (sequelize) => {
    const HistorialReenvios = sequelize.define('HistorialReenvios', {
        id: {
            type: DataTypes.INTEGER,
            primaryKey: true,
            autoIncrement: true
        },
        residente_id: {
            type: DataTypes.INTEGER,
            allowNull: false,
            references: {
                model: 'residentes',
                key: 'id'
            }
        },
        fecha_reenvio: {
            type: DataTypes.DATE,
            defaultValue: DataTypes.NOW
        },
        ip_admin: {
            type: DataTypes.INET,
            allowNull: true
        },
        resultado: {
            type: DataTypes.ENUM('exitoso', 'fallido', 'excedido'),
            defaultValue: 'exitoso'
        },
        mensaje_error: {
            type: DataTypes.TEXT,
            allowNull: true
        },
        token_expiracion: {
            type: DataTypes.DATE,
            allowNull: true
        },
        contador_reenvios: {
            type: DataTypes.INTEGER,
            defaultValue: 1
        }
    }, {
        tableName: 'historial_reenvios',
        timestamps: false,
        indexes: [
            {
                fields: ['residente_id', 'fecha_reenvio']
            },
            {
                fields: ['resultado']
            }
        ]
    });
    
    return HistorialReenvios;
};
5. Servicio de Email
// services/emailService.js
const enviarEmailInvitacion = async ({ email, nombre, token, edificio }) => {
    const enlaceInvitacion = `${process.env.FRONTEND_URL}/activar-cuenta?token=${token}`;
    
    const asunto = `Reinvitaci√≥n - Acceso a LifeBit - ${edificio}`;
    const contenido = `
        <h2>¬°Hola ${nombre}!</h2>
        <p>Te reenviamos el enlace de invitaci√≥n para acceder a LifeBit del edificio ${edificio}.</p>
        <p>Este enlace expirar√° en 24 horas.</p>
        <a href="${enlaceInvitacion}" style="background: #3B82F6; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px;">
            Activar mi cuenta
        </a>
        <p>Si el bot√≥n no funciona, copia y pega este enlace en tu navegador:</p>
        <p>${enlaceInvitacion}</p>
    `;
    
    return await emailService.enviar({
        to: email,
        subject: asunto,
        html: contenido
    });
};
Frontend Implementation
1. Hook: Actualizar useGestionResidentes.js
// Agregar al estado
const [reenviandoId, setReenviandoId] = useState(null);

// Nueva funci√≥n
const handleReenviarInvitacion = useCallback(async (residente) => {
    // Validaci√≥n b√°sica
    if (residente.estado !== 'pendiente') {
        toast.error('Solo se pueden reenviar invitaciones a residentes pendientes');
        return;
    }
    
    try {
        setReenviandoId(residente.id);
        
        const response = await apiService.post(`/admin/residentes/${residente.id}/reenviar-invitacion`);
        
        if (response.data.success) {
            toast.success(`Invitaci√≥n reenviada a ${residente.email}`);
            
            // Actualizar datos del residente
            setResidentes(prev => prev.map(r => 
                r.id === residente.id 
                    ? {
                        ...r,
                        reenvios_realizados: response.data.data.reenvios_realizados,
                        ultimo_reenvio: response.data.data.ultimo_reenvio,
                        token_expiracion: response.data.data.nuevo_token_expiracion
                    }
                    : r
            ));
            
        } else {
            // Manejar errores espec√≠ficos
            switch (response.data.error) {
                case 'REENVIOS_EXCEDIDOS':
                    toast.error(`L√≠mite de reenv√≠os alcanzado (${response.data.data.reenvios_realizados}/3)`);
                    break;
                case 'RESIDENTE_YA_ACTIVO':
                    toast.error('Este residente ya est√° activo');
                    break;
                default:
                    toast.error(response.data.message || 'Error al reenviar invitaci√≥n');
            }
        }
        
    } catch (error) {
        console.error('Error al reenviar invitaci√≥n:', error);
        toast.error('Error de conexi√≥n al reenviar invitaci√≥n');
    } finally {
        setReenviandoId(null);
    }
}, []);

// Agregar a la API p√∫blica del hook
return {
    // ... otros valores
    handleReenviarInvitacion,
    reenviandoId
};
2. Componente: Actualizar ListaResidentes.jsx
// Agregar imports
import { FiMail } from 'react-icons/fi';

// Agregar props
const ListaResidentes = ({
    residentes,
    isLoading,
    searchTerm,
    onSearchChange,
    filtroEstado,
    onFiltroChange,
    onRefresh,
    onEditar,
    onSuspender,
    onReenviarInvitacion,  // Nueva prop
    reenviandoId,          // Nueva prop
    eliminandoId
}) => {
    // Dentro del map de residentes
    {residentes.map((residente) => {
        const estadoBadge = getEstadoBadge(residente.estado);
        const puedeReenviar = residente.estado === 'pendiente' && residente.reenvios_realizados < 3;
        
        return (
            <tr key={residente.id} className="hover:bg-gray-750 transition-colors duration-150">
                {/* ... columnas existentes ... */}
                
                <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <div className="flex justify-end gap-2">
                        {/* Bot√≥n de editar existente */}
                        <button
                            onClick={() => onEditar(residente)}
                            className="text-blue-400 hover:text-blue-600 transition-colors duration-200 p-1"
                            title="Editar residente"
                        >
                            <FiEdit size={16} />
                        </button>
                        
                        {/* Nuevo bot√≥n de reenviar */}
                        {puedeReenviar && (
                            <button
                                onClick={() => onReenviarInvitacion(residente)}
                                disabled={reenviandoId === residente.id}
                                className="text-purple-400 hover:text-purple-600 transition-colors duration-200 p-1 disabled:opacity-50"
                                title={`Reenviar invitaci√≥n (${residente.reenvios_realizados || 0}/3)`}
                            >
                                {reenviandoId === residente.id ? (
                                    <FiRefreshCw className="animate-spin" size={16} />
                                ) : (
                                    <FiMail size={16} />
                                )}
                            </button>
                        )}
                        
                        {/* Bot√≥n de suspender existente */}
                        <button
                            onClick={() => onSuspender(residente)}
                            disabled={eliminandoId === residente.id}
                            className={`transition-colors duration-200 disabled:opacity-50 p-1 ${
                                residente.estado === 'suspendido'
                                    ? 'text-green-400 hover:text-green-600'
                                    : 'text-orange-400 hover:text-orange-600'
                            }`}
                            title={residente.estado === 'suspendido' ? 'Reactivar residente' : 'Suspender residente'}
                        >
                            {eliminandoId === residente.id ? (
                                <FiRefreshCw className="animate-spin" size={16} />
                            ) : residente.estado === 'suspendido' ? (
                                <FiUserCheck size={16} />
                            ) : (
                                <FiUserX size={16} />
                            )}
                        </button>
                    </div>
                </td>
            </tr>
        );
    })}
3. P√°gina: Actualizar ResidentesPage.jsx
// En el hook useGestionResidentes
const {
    residentesFiltrados,
    estadisticas,
    isLoading,
    ultimaActualizacion,
    searchTerm,
    setSearchTerm,
    filtroEstado,
    setFiltroEstado,
    isInvitarModalOpen,
    isMasivoModalOpen,
    isSuspenderModalOpen,
    residenteEditando,
    residenteASuspender,
    datosBorrador,
    handleOpenInvitarModal,
    setIsMasivoModalOpen,
    handleEditarResidente,
    handleSuspenderResidente,
    handleCloseModals,
    confirmarCambioEstado,
    eliminandoId,
    handleInvitacionExitosa,
    cargarResidentes,
    handleReenviarInvitacion,  // Nueva funci√≥n
    reenviandoId               // Nuevo estado
} = useGestionResidentes();

// En el componente ListaResidentes
<ListaResidentes
    residentes={residentesFiltrados}
    isLoading={isLoading}
    searchTerm={searchTerm}
    onSearchChange={setSearchTerm}
    filtroEstado={filtroEstado}
    onFiltroChange={setFiltroEstado}
    onRefresh={cargarResidentes}
    onEditar={handleEditarResidente}
    onSuspender={handleSuspenderResidente}
    onReenviarInvitacion={handleReenviarInvitacion}  // Nueva prop
    reenviandoId={reenviandoId}                      // Nueva prop
    eliminandoId={eliminandoId}
/>
üîÑ Consecuencias
Positivas:
‚úÖ Mejora UX: Soluci√≥n inmediata para tokens expirados
‚úÖ Eficiencia: Reenv√≠o directo desde la lista sin navegaci√≥n
‚úÖ Auditor√≠a: Historial completo de reenv√≠os
‚úÖ Escalabilidad: L√≠mite controlado de reenv√≠os
‚úÖ Consistencia: Mantiene arquitectura existente
Riesgos:
‚ö†Ô∏è Abuso: Posibilidad de spam (mitigado con l√≠mite de 3)
‚ö†Ô∏è Complejidad: Nueva tabla y l√≥gica (aceptable)
‚ö†Ô∏è Almacenamiento: Historial crece con el tiempo (optimizado con √≠ndices)
Alternativas Consideradas:
Sin l√≠mite de reenv√≠os: Rechazada por riesgo de abuso
Reenv√≠o autom√°tico: Rechazada por complejidad operativa
Modal separado: Rechazada por peor UX
üìã Plan de Implementaci√≥n
Fase 1: Backend (2-3 horas)
 Crear tabla historial_reenvios
 Actualizar tabla residentes
 Implementar endpoint /admin/residentes/:id/reenviar-invitacion
 Crear modelo HistorialReenvios
 Actualizar servicio de email
Fase 2: Frontend (1-2 horas)
 Actualizar hook useGestionResidentes
 Modificar componente ListaResidentes
 Actualizar ResidentesPage
 Testing manual
Fase 3: Testing (1 hora)
 Pruebas unitarias
 Pruebas de integraci√≥n
 Validaci√≥n manual
üìä M√©tricas de √âxito
‚úÖ Adopci√≥n: 80% de administradores usan la funcionalidad
‚úÖ Satisfacci√≥n: Reducci√≥n del 90% en quejas sobre tokens expirados
‚úÖ Rendimiento: < 2 segundos de respuesta en reenv√≠os
‚úÖ Confiabilidad: < 1% de errores en reenv√≠os
üìù Notas Adicionales
Monitoreo: Logs de reenv√≠os para an√°lisis de uso
Documentaci√≥n: Actualizar API docs con nuevo endpoint
Migraci√≥n: Script para inicializar reenvios_realizados = 0 en residentes existentes
Rollback: F√°cil de revertir eliminando bot√≥n y endpoint
Estado: ‚è≥ Pendiente de Implementaci√≥n
Prioridad: üî¥ Alta
Esfuerzo Estimado: 4-6 horas